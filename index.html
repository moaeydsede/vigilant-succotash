<!DOCTYPE html>

<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1,viewport-fit=cover" name="viewport"/>
<meta content="#0b1220" name="theme-color"/>
<meta content="Customer Evaluation โ CRM Score v2.3.0 VIP" name="description"/>
<title>Customer Evaluation โ CRM Score (VIP)</title>
<link href="./manifest.json" rel="manifest"/>
<link href="./assets/favicon-192.png" rel="icon" sizes="192x192"/>
<link href="./assets/icon-192.png" rel="apple-touch-icon"/>
<link href="./app.css" rel="stylesheet">
<!-- Libraries (CDN) -->
<script defer="" src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script defer="" src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
<script defer="" src="https://cdn.jsdelivr.net/npm/jspdf-autotable@3.8.2/dist/jspdf.plugin.autotable.min.js"></script>
<script defer="" src="./app.js"></script>
</link></head>
<body>
<div id="app">
<!-- Topbar -->
<header class="topbar">
<button aria-label="ุงููุงุฆูุฉ" class="icon-btn" id="btnMenu">
<span class="hamburger"></span>
</button>
<div class="topbar-title">
<div class="brand-title">CRM Score</div>
<div class="brand-sub" id="brandSub">VIP v2.3.0</div>
</div>
<div class="topbar-actions">
<button class="pill-btn" id="btnRecalc" title="ุฅุนุงุฏุฉ ุงูุญุณุงุจ">ุฅุนุงุฏุฉ ุงูุญุณุงุจ</button>
<button class="pill-btn danger" id="btnLogout" title="ุฎุฑูุฌ">ุฎุฑูุฌ</button>
</div>
</header>
<!-- Sidebar / Bottom sheet -->
<aside aria-hidden="true" class="sidebar" id="sidebar">
<div class="sidebar-head">
<div class="sidebar-user">
<div class="avatar" id="sessionAvatar">A</div>
<div>
<div class="sidebar-name" id="sessionName">โ</div>
<div class="sidebar-role" id="sessionRole">โ</div>
</div>
</div>
<button aria-label="ุฅุบูุงู" class="icon-btn" id="btnCloseMenu">
          โ
        </button>
</div>
<nav class="sidebar-nav">
<button class="nav-item" data-view="dashboard">ููุญุฉ ุงูุชุญูู</button>
<button class="nav-item" data-view="customers">ุงูุนููุงุก</button>
<button class="nav-item" data-view="transactions">ุงูุญุฑูุงุช</button>
<button class="nav-item" data-view="reports">ุงูุชูุงุฑูุฑ</button>
<button class="nav-item" data-view="ratios">ููุณุจ</button>
<button class="nav-item" data-view="excel">Excel</button>
<button class="nav-item" data-view="pdf">PDF</button>
<button class="nav-item" data-view="company">ุจูุงูุงุช ุงูุดุฑูุฉ</button>
<button class="nav-item admin-only" data-view="users">ุงููุณุชุฎุฏููู</button>
</nav>
<div class="sidebar-foot">
<button class="pill-btn warn" id="btnWipeLocal">ูุณุญ ุงูุจูุงูุงุช ุงููุญููุฉ</button>
<div class="muted small">* ููุถุฑูุฑุฉ ููุท โ ูุง ุฑุฌุนุฉ</div>
</div>
</aside>
<div class="backdrop" hidden="" id="backdrop"></div>
<!-- Main -->
<main class="main">
<!-- Login View -->
<section class="view" data-view="login" id="view-login">
<div class="login-wrap">
<div class="login-card">
<div class="login-head">
<div class="login-logo">
<img alt="CRM" id="loginLogo" src="./assets/icon-192.png"/>
</div>
<div>
<div class="login-title">Customer Evaluation โ CRM Score</div>
<div class="login-sub">VIP v2.3.0 โข ุนุฑุจู 100ูช</div>
</div>
</div>
<div class="login-tabs" role="tablist">
<button aria-selected="true" class="tab active" data-login-tab="staff" role="tab">ุงูุฅุฏุงุฑุฉ / ุงููุญุงุณุจุฉ</button>
<button aria-selected="false" class="tab" data-login-tab="viewer" role="tab">ุนุฑุถ ููุท</button>
</div>
<form class="login-form" id="loginForm">
<div class="field">
<label>ุงุณู ุงููุณุชุฎุฏู</label>
<input autocomplete="username" id="loginUser" placeholder="admin" required="" type="text"/>
</div>
<div class="field">
<label>ูููุฉ ุงููุฑูุฑ</label>
<div class="input-wrap">
<input autocomplete="current-password" id="loginPass" placeholder="admin123" required="" type="password"/>
<button aria-label="ุฅุธูุงุฑ/ุฅุฎูุงุก ูููุฉ ุงููุฑูุฑ" class="icon-eye" id="togglePass" title="ุฅุธูุงุฑ/ุฅุฎูุงุก" type="button">
<span></span>
</button>
</div>
</div>
<button class="btn primary" id="btnLogin" type="submit">ุฏุฎูู</button>
<div class="form-msg err" hidden="" id="loginError"></div>
<div class="row-between">
<label class="check">
<input checked="" id="rememberMe" type="checkbox"/>
<span>ุชุฐูุฑูู</span>
</label>
<button class="link-btn" id="btnClearLogin" type="button">ูุณุญ ุงูุญููู</button>
</div>
<div class="hint">
                ุงูุญุณุงุจ ุงูุฑุฆูุณู: <b>admin</b> / <b>admin123</b>
</div>
</form>
<form class="login-form" hidden="" id="viewerForm">
<div class="field">
<label>ุฑูุฒ ุงูุนุฑุถ (ุงุฎุชูุงุฑู)</label>
<input id="viewerCode" placeholder="ูุซุงู: VIEW123" type="text"/>
</div>
<button class="btn primary" type="submit">ุฏุฎูู (ุนุฑุถ ููุท)</button>
<div class="hint muted">
                * ุฅุฐุง ูู ูุชู ุชูุนูู ุฑูุฒ ุงูุนุฑุถ ูู ุงูุฅุนุฏุงุฏุงุช ุณูุชู ุงูุฏุฎูู ูู Viewer ุนุงู.
              </div>
</form>
<div class="login-foot">
<button class="link" id="btnInstallPwa" type="button">ุชุซุจูุช ูุชุทุจูู (PWA)</button>
<span class="dot">โข</span>
<button class="link" id="btnSeedDemo" type="button">ุจูุงูุงุช ุชุฌุฑูุจูุฉ</button>
</div>
</div>
</div>
</section>
<!-- Dashboard -->
<section class="view" data-view="dashboard" hidden="" id="view-dashboard">
<div class="panel">
<div class="panel-title">ููุญุฉ ุงูุชุญูู</div>
<div class="kpi-grid">
<div class="kpi">
<div class="kpi-label">ุนุฏุฏ ุงูุนููุงุก</div>
<div class="kpi-value" id="kpiCustomers">0</div>
</div>
<div class="kpi">
<div class="kpi-label">ุฅุฌูุงูู ุงููุจูุนุงุช</div>
<div class="kpi-value" id="kpiSales">0</div>
</div>
<div class="kpi">
<div class="kpi-label">ุฅุฌูุงูู ุงูุณุฏุงุฏ</div>
<div class="kpi-value" id="kpiPayments">0</div>
</div>
<div class="kpi">
<div class="kpi-label">ูุณุจุฉ ุงูุณุฏุงุฏ</div>
<div class="kpi-value" id="kpiPayRatio">0%</div>
</div>
</div>
<div class="panel-sub">
<div class="row between">
<div class="muted">ุฃูุถู ุงูุนููุงุก</div>
<button class="pill-btn" id="btnGoCustomers">ุนุฑุถ ุงููู</button>
</div>
</div>
<div class="cards" id="topCustomersList"></div>
</div>
</section>
<!-- Customers -->
<section class="view" data-view="customers" hidden="" id="view-customers">
<div class="panel">
<div class="panel-title">ุงูุนููุงุก</div>
<div class="toolbar">
<input id="custSearch" placeholder="ุจุญุซ ุจุงูุงุณู / ุงููุงุชู / ุงููุฏููุฉ..." type="search"/>
<div class="row gap wrap">
<select id="custCityFilter" title="ุงููุฏููุฉ">
<option value="">ูู ุงููุฏู</option>
</select>
<select id="custStatusFilter" title="ุงูุญุงูุฉ">
<option value="">ูู ุงูุญุงูุงุช</option>
<option value="active">ูุดุท</option>
<option value="blocked">ููููู</option>
</select>
<button class="btn primary" id="btnAddCustomer">+ ุฅุถุงูุฉ ุนููู</button>
</div>
</div>
<div class="cards" id="customersList"></div>
<div class="muted small">* ุงุถุบุท ุนูู ุจุทุงูุฉ ุงูุนููู ูุนุฑุถ ุงูุชูุงุตููุ ุฃู ุงุณุชุฎุฏู ุงูุฃุฒุฑุงุฑ ุฏุงุฎู ุงูุจุทุงูุฉ.</div>
</div>
</section>
<!-- Transactions -->
<section class="view" data-view="transactions" hidden="" id="view-transactions">
<div class="panel">
<div class="panel-title">ุงูุญุฑูุงุช</div>
<div class="toolbar">
<div class="row gap wrap">
<button class="btn primary" data-add-tx="sale">+ ุจูุน</button>
<button class="btn" data-add-tx="payment">+ ุณุฏุงุฏ</button>
<button class="btn warn" data-add-tx="return">+ ูุฑุชุฌุน</button>
<button class="btn danger" data-add-tx="discount">+ ุฎุตู</button>
</div>
<div class="row gap wrap">
<input id="txSearch" placeholder="ุจุญุซ ุจุงููุงุชูุฑุฉ / ุงุณู ุงูุนููู..." type="search"/>
<input id="txFrom" type="date"/>
<input id="txTo" type="date"/>
<button class="btn" id="btnTxClearDates" type="button">ูุณุญ ุงูุชูุงุฑูุฎ</button>
</div>
</div>
<div class="cards" id="txList"></div>
</div>
</section>
<!-- Ratios -->
<section class="view" data-view="ratios" hidden="" id="view-ratios">
<div class="panel">
<div class="panel-title">ุตูุญุฉ ุงูููุณุจ (CRM)</div>
<div class="toolbar">
<div class="row gap wrap">
<input id="ratSearch" placeholder="ุจุญุซ ุนู ุนููู..." type="search"/>
<select id="ratSort" title="ุชุฑุชูุจ">
<option value="score_desc">ุงูุฃุนูู ุชูููููุง</option>
<option value="sales_desc">ุงูุฃุนูู ูุจูุนุงุช</option>
<option value="returns_asc">ุงูุฃูู ูุฑุชุฌุนุงุช</option>
<option value="netpay_desc">ุงูุฃุนูู (ุตุงูู ุงููุจูุนุงุช/ุงูุณุฏุงุฏ)</option>
<option value="discounts_asc">ุงูุฃูู ุฎุตููุงุช</option>
</select>
</div>
<div class="row gap wrap">
<input id="ratFrom" type="date"/>
<input id="ratTo" type="date"/>
<button class="btn primary" id="btnRatiosRefresh" type="button">ุชุญุฏูุซ</button>
<button class="btn" id="btnRatClear" type="button">ูุณุญ</button>
</div>
<div class="row gap wrap">
<button class="btn primary" id="btnRatShowReturns" type="button">ุนุฑุถ ุงููุณุจุฉ: ูุจูุนุงุช โ ูุฑุชุฌุนุงุช</button>
<button class="btn" id="btnRatShowNetPay" type="button">ุนุฑุถ ุงููุณุจุฉ: ุตุงูู ุงููุจูุนุงุช โ ุงูุณุฏุงุฏ</button>
</div>
<div class="rat-summary" id="ratSummary"></div>
<div class="row gap wrap">
<button class="btn warn" id="btnRatPrintReturns" type="button">ุทุจุงุนุฉ: ูุจูุนุงุช/ูุฑุชุฌุนุงุช</button>
<button class="btn" id="btnRatPrintPayments" type="button">ุทุจุงุนุฉ: ูุจูุนุงุช/ุณุฏุงุฏ</button>
<button class="btn danger" id="btnRatPrintDiscounts" type="button">ุทุจุงุนุฉ: ูุจูุนุงุช/ุฎุตููุงุช</button>
</div>
</div>
<div class="cards" id="ratList"></div>
<div class="muted small">* ูุฐู ุงูุตูุญุฉ ุชุนุฑุถ ุงููุณุจ ููู ุนููู ูุน ุชูููู ุงููุฌูู.</div>
</div>
</section>
<!-- Reports -->
<section class="view" data-view="reports" hidden="" id="view-reports">
<div class="panel">
<div class="panel-title">ุงูุชูุงุฑูุฑ</div>
<div class="toolbar">
<div class="row gap wrap">
<input id="repFrom" type="date"/>
<input id="repTo" type="date"/>
<button class="btn primary" id="btnRepApply" type="button">ุชุทุจูู</button>
<button class="btn" id="btnRepClear" type="button">ูุณุญ</button>
<button class="btn" id="btnReportPdf" type="button">ุทุจุงุนุฉ PDF</button>
</div>
</div>
<div class="kpi-grid">
<div class="kpi">
<div class="kpi-label">ุฅุฌูุงูู ุงููุจูุนุงุช</div>
<div class="kpi-value" id="repSales">0</div>
</div>
<div class="kpi">
<div class="kpi-label">ุฅุฌูุงูู ุงูุณุฏุงุฏ</div>
<div class="kpi-value" id="repPayments">0</div>
</div>
<div class="kpi">
<div class="kpi-label">ูุณุจุฉ ุงูุณุฏุงุฏ</div>
<div class="kpi-value" id="repPayPct">0%</div>
</div>
<div class="kpi">
<div class="kpi-label">ูุณุจุฉ ุงููุฑุชุฌุนุงุช</div>
<div class="kpi-value" id="repRetPct">0%</div>
</div>
</div>
<div class="panel-sub">
<div class="muted">ุฃูุถู ุงูุนููุงุก ุฎูุงู ุงููุชุฑุฉ</div>
</div>
<div class="cards" id="repTopCustomers"></div>
</div>
</section>
<!-- Excel -->
<section class="view" data-view="excel" hidden="" id="view-excel">
<div class="panel">
<div class="panel-title">Excel (ุงุณุชูุฑุงุฏ / ุชุตุฏูุฑ)</div>
<div class="grid2">
<div class="card">
<div class="card-title">ููุงูุจ ุฌุงูุฒุฉ</div>
<div class="card-body">
<button class="btn primary" id="btnDownloadTemplate" type="button">ุชุญููู ูุงูุจ ูุงูู</button>
<button class="btn" id="btnDownloadCustomersTemplate" type="button">ุชุญููู ูุงูุจ ุงูุนููุงุก ููุท</button>
<div class="muted small">* ุงุณุชุฎุฏู ุงููุงูุจ ูุถูุงู ุงูุงุณุชูุฑุงุฏ ุงูุตุญูุญ.</div>
</div>
</div>
<div class="card">
<div class="card-title">ุชุตุฏูุฑ</div>
<div class="card-body">
<button class="btn primary" id="btnExportAll" type="button">ุชุตุฏูุฑ ูู ุงูุจูุงูุงุช</button>
<button class="btn" id="btnExportCustomersOnly" type="button">ุชุตุฏูุฑ ุงูุนููุงุก ููุท</button>
</div>
</div>
<div class="card">
<div class="card-title">ุงุณุชูุฑุงุฏ</div>
<div class="card-body">
<button class="btn primary" id="btnImportAll" type="button">ุงุณุชูุฑุงุฏ ูู ุงูุจูุงูุงุช</button>
<button class="btn" id="btnImportCustomersOnly" type="button">ุงุณุชูุฑุงุฏ ุงูุนููุงุก ููุท</button>
<input accept=".xlsx,.xls" hidden="" id="fileImportAll" type="file"/>
<input accept=".xlsx,.xls" hidden="" id="fileImportCustomers" type="file"/>
<div class="muted small">* ุจุนุฏ ุงูุงุณุชูุฑุงุฏ ุณูุชู ุชุญุฏูุซ ุงูุญุณุงุจุงุช ุชููุงุฆููุง.</div>
</div>
</div>
<div class="card">
<div class="card-title">ุณุฌู ุงูุนูููุงุช</div>
<div class="card-body">
<button class="btn" id="btnClearLog" type="button">ูุณุญ ุงูุณุฌู</button>
<div class="log" id="opsLog"></div>
</div>
</div>
</div>
</div>
</section>
<!-- Tabbar -->
<nav class="tabbar" hidden="" id="tabbar">
<button class="tabbtn" data-view="dashboard" type="button"><div class="ico">๐</div><div class="lbl">ุงูุฑุฆูุณูุฉ</div></button>
<button class="tabbtn" data-view="customers" type="button"><div class="ico">๐ค</div><div class="lbl">ุงูุนููุงุก</div></button>
<button class="tabbtn" data-view="transactions" type="button"><div class="ico">๐งพ</div><div class="lbl">ุงูุญุฑูุงุช</div></button>
<button class="tabbtn" data-view="ratios" type="button"><div class="ico">๐</div><div class="lbl">ุงูููุณุจ</div></button>
<button class="tabbtn" data-view="reports" type="button"><div class="ico">๐</div><div class="lbl">ุงูุชูุงุฑูุฑ</div></button>
</nav>

<!-- PDF -->
<section class="view" data-view="pdf" hidden="" id="view-pdf">
<div class="panel">
<div class="panel-title">PDF (A4)</div>
<div class="grid2">
<div class="card">
<div class="card-title">ุฃูุถู ุงูุนููุงุก</div>
<div class="card-body">
<button class="btn primary" id="btnPdfTop">ุทุจุงุนุฉ ุฃูุถู ุงูุนููุงุก</button>
<div class="muted small">ูุนุชูุฏ ุนูู ุขุฎุฑ ุฅุนุงุฏุฉ ุญุณุงุจ.</div>
</div>
</div>
<div class="card">
<div class="card-title">ูุดู ุญุณุงุจ ุนููู</div>
<div class="card-body">
<div class="field">
<label>ุงุฎุชูุงุฑ ุนููู</label>
<select class="select" id="stmtCustomer"></select>
</div>
<div class="date-range">
<input id="stmtFrom" type="date"/>
<span class="muted">ุฅูู</span>
<input id="stmtTo" type="date"/>
</div>
<button class="btn primary" id="btnPdfStatement">ุทุจุงุนุฉ ูุดู ุงูุญุณุงุจ</button>
</div>
</div>
<div class="card">
<div class="card-title">ุชูุงุฑูุฑ ุงูููุณุจ (ูู ุชูุฑูุฑ ููุญุฏู)</div>
<div class="card-body">
<div class="date-range">
<input id="pdfRepFrom" type="date"/>
<span class="muted">ุฅูู</span>
<input id="pdfRepTo" type="date"/>
<button class="pill-btn" id="btnPdfRepClear">ูุณุญ</button>
</div>
<button class="btn primary" id="btnPdfSalesReturns">ุชูุฑูุฑ: ุงููุจูุนุงุช โ ุงููุฑุชุฌุนุงุช</button>
<button class="btn primary" id="btnPdfSalesPayments">ุชูุฑูุฑ: ุงููุจูุนุงุช โ ุงูุณุฏุงุฏ</button>
<button class="btn primary" id="btnPdfSalesDiscounts">ุชูุฑูุฑ: ุงููุจูุนุงุช โ ุงูุฎุตููุงุช</button>
<div class="muted small">ูุชุถูู (ุงูููุณุจ + ุงูุชูููู ุจุงููุฌูู) ููู ุนููู.</div>
</div>
</div>
</div>
</div>
</section>
<!-- Company -->
<section class="view" data-view="company" hidden="" id="view-company">
<div class="panel">
<div class="panel-title">ุจูุงูุงุช ุงูุดุฑูุฉ</div>
<div class="form-grid">
<div class="field">
<label>ุงุณู ุงูุดุฑูุฉ</label>
<input id="coName" placeholder="ุงุณู ุงูุดุฑูุฉ" type="text"/>
</div>
<div class="field">
<label>ุงููุงุชู</label>
<input id="coPhone" placeholder="0100..." type="text"/>
</div>
<div class="field">
<label>ุงููุฏููุฉ</label>
<input id="coCity" placeholder="ุงููุงูุฑุฉ" type="text"/>
</div>
<div class="field">
<label>ุฑุงุจุท ุงูุดุนุงุฑ (URL)</label>
<input id="coLogoUrl" placeholder="https://..." type="url"/>
</div>
<div class="card soft">
<div class="card-title">Viewer Code (ุงุฎุชูุงุฑู)</div>
<div class="card-body">
<div class="field">
<label>ุฑูุฒ ุฏุฎูู ุงูุนุฑุถ ููุท</label>
<input id="viewerCodeSetting" placeholder="ูุซุงู: VIEW123" type="text"/>
</div>
<div class="muted small">ุฅุฐุง ูุงู ูุงุฑุบูุง: ุงูุฏุฎูู ูู Viewer ุนุงู.</div>
</div>
</div>
<div class="card soft">
<div class="card-title">Firebase (ุงุฎุชูุงุฑู)</div>
<div class="card-body">
<div class="muted small">ูุฐู ุงูุฅุนุฏุงุฏุงุช ูุญููุธุฉ ููุท โ ุงููุฒุงููุฉ ููุณุช ููุนูุฉ ุงูุชุฑุงุถููุง (ุจุฏูู ุณูุฑูุฑ).</div>
<textarea id="fbConfig" placeholder='{"apiKey":"...","projectId":"..."}' rows="6"></textarea>
</div>
</div>
<div class="row gap">
<button class="btn primary" id="btnSaveCompany">ุญูุธ</button>
<button class="btn" id="btnPreviewLogo">ูุนุงููุฉ ุงูุดุนุงุฑ</button>
</div>
<div class="logo-preview" hidden="" id="logoPreview">
<img alt="logo" id="logoPreviewImg"/>
</div>
</div>
</div>
</section>
<!-- Users (Admin only) -->
<section class="view" data-view="users" hidden="" id="view-users">
<div class="panel">
<div class="panel-title">ุงููุณุชุฎุฏููู (Admin ููุท)</div>
<div class="toolbar">
<button class="btn primary" id="btnAddUser">+ ุฅุถุงูุฉ ูุณุชุฎุฏู</button>
</div>
<div class="cards" id="usersList"></div>
</div>
</section>
</main>
<!-- Bottom Tab Bar -->
<footer class="tabbar" hidden="" id="tabbar">
<button class="tabbtn" data-view="dashboard">
<span class="ico">๐</span><span class="lbl">ุงูุฑุฆูุณูุฉ</span>
</button>
<button class="tabbtn" data-view="customers">
<span class="ico">๐ฅ</span><span class="lbl">ุงูุนููุงุก</span>
</button>
<button class="tabbtn" data-view="transactions">
<span class="ico">๐งพ</span><span class="lbl">ุงูุญุฑูุงุช</span>
</button>
<button class="tabbtn" data-view="reports">
<span class="ico">๐</span><span class="lbl">ุงูุชูุงุฑูุฑ</span>
</button>
<button class="tabbtn" data-view="excel">
<span class="ico">๐ฅ</span><span class="lbl">Excel</span>
</button>
</footer>
<!-- Modal -->
<div class="modal" hidden="" id="modal">
<div class="modal-card">
<div class="modal-head">
<div class="modal-title" id="modalTitle">โ</div>
<button aria-label="ุฅุบูุงู" class="icon-btn" id="modalClose">โ</button>
</div>
<div class="modal-body" id="modalBody"></div>
<div class="modal-foot" id="modalFoot"></div>
</div>
</div>
<!-- Toast -->
<div class="toast" hidden="" id="toast"></div>
</div>
</body>
</html>
